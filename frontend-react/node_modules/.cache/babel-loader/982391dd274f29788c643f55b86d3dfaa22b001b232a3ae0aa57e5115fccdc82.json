{"ast":null,"code":"var _jsxFileName = \"D:\\\\wamp64\\\\www\\\\hrms\\\\frontend-react\\\\src\\\\routes\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst routeRoleMap = {\n  // Employee routes (role 4)\n  \"/dashboard\": [4],\n  \"/profile\": [4],\n  \"/attendance\": [4],\n  \"/leaves\": [4],\n  \"/salary\": [4],\n  \"/payslips\": [4],\n  \"/announcements\": [4],\n  // Admin routes (roles 1, 2)\n  \"/admin/dashboard\": [1, 2],\n  \"/admin/employees\": [1, 2],\n  \"/admin/leaves\": [1, 2],\n  \"/admin/attendance\": [1, 2],\n  \"/admin/payslips\": [1, 2],\n  \"/admin/salaries\": [1, 2],\n  \"/admin/departments\": [1, 2],\n  \"/admin/designations\": [1, 2],\n  \"/admin/announcements\": [1, 2],\n  \"/admin/settings\": [1],\n  \"/admin/documents\": [1, 2],\n  \"/admin/recruitment\": [1, 2],\n  \"/admin/performance-reviews\": [1, 2],\n  \"/admin/profile\": [1, 2],\n  // HR routes (role 3)\n  \"/hr/dashboard\": [3],\n  \"/hr/leaves\": [3],\n  \"/hr/attendance\": [3],\n  \"/hr/recruitment\": [3],\n  \"/hr/employees\": [3],\n  // SuperAdmin routes (role 1)\n  \"/superadmin/dashboard\": [1],\n  \"/superadmin/employees\": [1],\n  \"/superadmin/departments\": [1],\n  \"/superadmin/designations\": [1],\n  \"/superadmin/attendance\": [1],\n  \"/superadmin/leaves\": [1],\n  \"/superadmin/salaries\": [1],\n  \"/superadmin/payslips\": [1],\n  \"/superadmin/documents\": [1],\n  \"/superadmin/recruitment\": [1],\n  \"/superadmin/performance-reviews\": [1],\n  \"/superadmin/announcements\": [1],\n  \"/superadmin/settings\": [1],\n  \"/superadmin/system-controls\": [1],\n  \"/superadmin/notifications\": [1],\n  \"/superadmin/activity-log\": [1],\n  \"/superadmin/users\": [1],\n  \"/superadmin/reports\": [1]\n};\nconst ProtectedRoute = ({\n  children,\n  roles\n}) => {\n  _s();\n  const location = useLocation();\n  const {\n    user,\n    token,\n    isBootstrapping\n  } = useAuth();\n  if (isBootstrapping) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 12\n    }, this);\n  }\n  if (!token || !user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 1. Check if the route is explicitly restricted via props (legacy support or extra safety)\n  if (roles && !roles.includes(user.role_id)) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: getRedirectPath(user.role_id),\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 2. Check routeRoleMap for the current path\n  // Find longest matching prefix\n  const currentPath = location.pathname;\n  const matchedRoute = Object.keys(routeRoleMap).find(route => {\n    // Exact match or prefix match with slash boundary\n    return currentPath === route || currentPath.startsWith(`${route}/`);\n  });\n  if (matchedRoute) {\n    const allowedRoles = routeRoleMap[matchedRoute];\n    if (!allowedRoles.includes(user.role_id)) {\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: getRedirectPath(user.role_id),\n        replace: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 14\n      }, this);\n    }\n  }\n  return children;\n};\n_s(ProtectedRoute, \"vmZ8kY+SAEJiI0iVRUU8ruzR/Gw=\", false, function () {\n  return [useLocation, useAuth];\n});\n_c = ProtectedRoute;\nconst getRedirectPath = roleId => {\n  switch (roleId) {\n    case 4:\n      return \"/dashboard\";\n    case 3:\n      return \"/hr/dashboard\";\n    case 2:\n      return \"/admin/dashboard\";\n    case 1:\n      return \"/superadmin/dashboard\";\n    // Or admin dashboard if preferred, but superadmin specific requested\n    default:\n      return \"/login\";\n  }\n};\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["Navigate","useLocation","useAuth","jsxDEV","_jsxDEV","routeRoleMap","ProtectedRoute","children","roles","_s","location","user","token","isBootstrapping","fileName","_jsxFileName","lineNumber","columnNumber","to","replace","includes","role_id","getRedirectPath","currentPath","pathname","matchedRoute","Object","keys","find","route","startsWith","allowedRoles","_c","roleId","$RefreshReg$"],"sources":["D:/wamp64/www/hrms/frontend-react/src/routes/ProtectedRoute.js"],"sourcesContent":["import { Navigate, useLocation } from \"react-router-dom\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\n\r\nconst routeRoleMap = {\r\n  // Employee routes (role 4)\r\n  \"/dashboard\": [4],\r\n  \"/profile\": [4],\r\n  \"/attendance\": [4],\r\n  \"/leaves\": [4],\r\n  \"/salary\": [4],\r\n  \"/payslips\": [4],\r\n  \"/announcements\": [4],\r\n\r\n  // Admin routes (roles 1, 2)\r\n  \"/admin/dashboard\": [1, 2],\r\n  \"/admin/employees\": [1, 2],\r\n  \"/admin/leaves\": [1, 2],\r\n  \"/admin/attendance\": [1, 2],\r\n  \"/admin/payslips\": [1, 2],\r\n  \"/admin/salaries\": [1, 2],\r\n  \"/admin/departments\": [1, 2],\r\n  \"/admin/designations\": [1, 2],\r\n  \"/admin/announcements\": [1, 2],\r\n  \"/admin/settings\": [1],\r\n  \"/admin/documents\": [1, 2],\r\n  \"/admin/recruitment\": [1, 2],\r\n  \"/admin/performance-reviews\": [1, 2],\r\n  \"/admin/profile\": [1, 2],\r\n\r\n  // HR routes (role 3)\r\n  \"/hr/dashboard\": [3],\r\n  \"/hr/leaves\": [3],\r\n  \"/hr/attendance\": [3],\r\n  \"/hr/recruitment\": [3],\r\n  \"/hr/employees\": [3],\r\n\r\n  // SuperAdmin routes (role 1)\r\n  \"/superadmin/dashboard\": [1],\r\n  \"/superadmin/employees\": [1],\r\n  \"/superadmin/departments\": [1],\r\n  \"/superadmin/designations\": [1],\r\n  \"/superadmin/attendance\": [1],\r\n  \"/superadmin/leaves\": [1],\r\n  \"/superadmin/salaries\": [1],\r\n  \"/superadmin/payslips\": [1],\r\n  \"/superadmin/documents\": [1],\r\n  \"/superadmin/recruitment\": [1],\r\n  \"/superadmin/performance-reviews\": [1],\r\n  \"/superadmin/announcements\": [1],\r\n  \"/superadmin/settings\": [1],\r\n  \"/superadmin/system-controls\": [1],\r\n  \"/superadmin/notifications\": [1],\r\n  \"/superadmin/activity-log\": [1],\r\n  \"/superadmin/users\": [1],\r\n  \"/superadmin/reports\": [1],\r\n};\r\n\r\nconst ProtectedRoute = ({ children, roles }) => {\r\n  const location = useLocation();\r\n  const { user, token, isBootstrapping } = useAuth();\r\n\r\n  if (isBootstrapping) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  if (!token || !user) {\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  // 1. Check if the route is explicitly restricted via props (legacy support or extra safety)\r\n  if (roles && !roles.includes(user.role_id)) {\r\n    return <Navigate to={getRedirectPath(user.role_id)} replace />;\r\n  }\r\n\r\n  // 2. Check routeRoleMap for the current path\r\n  // Find longest matching prefix\r\n  const currentPath = location.pathname;\r\n  const matchedRoute = Object.keys(routeRoleMap).find((route) => {\r\n    // Exact match or prefix match with slash boundary\r\n    return currentPath === route || currentPath.startsWith(`${route}/`);\r\n  });\r\n\r\n  if (matchedRoute) {\r\n    const allowedRoles = routeRoleMap[matchedRoute];\r\n    if (!allowedRoles.includes(user.role_id)) {\r\n      return <Navigate to={getRedirectPath(user.role_id)} replace />;\r\n    }\r\n  }\r\n\r\n  return children;\r\n};\r\n\r\nconst getRedirectPath = (roleId) => {\r\n  switch (roleId) {\r\n    case 4:\r\n      return \"/dashboard\";\r\n    case 3:\r\n      return \"/hr/dashboard\";\r\n    case 2:\r\n      return \"/admin/dashboard\";\r\n    case 1:\r\n      return \"/superadmin/dashboard\"; // Or admin dashboard if preferred, but superadmin specific requested\r\n    default:\r\n      return \"/login\";\r\n  }\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}