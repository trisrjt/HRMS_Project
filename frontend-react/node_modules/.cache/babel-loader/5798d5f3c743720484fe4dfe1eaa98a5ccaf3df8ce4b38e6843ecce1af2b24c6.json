{"ast":null,"code":"var _jsxFileName = \"D:\\\\wamp64\\\\www\\\\hrms\\\\frontend-react\\\\src\\\\context\\\\NotificationContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useState, useEffect, useCallback } from \"react\";\nimport api from \"../api/axios\";\nimport { useAuth } from \"./AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NotificationContext = /*#__PURE__*/createContext();\nexport const useNotifications = () => {\n  _s();\n  return useContext(NotificationContext);\n};\n_s(useNotifications, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const NotificationProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    user\n  } = useAuth();\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Fetch all notifications\n  const fetchNotifications = useCallback(async () => {\n    if (!user) return;\n    setLoading(true);\n    try {\n      const response = await api.get(\"/notifications\");\n      setNotifications(response.data);\n      setError(null);\n    } catch (err) {\n      console.error(\"Failed to fetch notifications\", err);\n      setError(\"Failed to load notifications\");\n    } finally {\n      setLoading(false);\n    }\n  }, [user]);\n\n  // Fetch only unread count\n  const fetchUnreadCount = useCallback(async () => {\n    if (!user) return;\n    try {\n      const response = await api.get(\"/notifications/unread-count\");\n      setUnreadCount(response.data.unread);\n    } catch (err) {\n      console.error(\"Failed to fetch unread count\", err);\n    }\n  }, [user]);\n\n  // Mark single as read\n  const markRead = async id => {\n    try {\n      await api.post(`/notifications/mark-read/${id}`);\n      // Update local state\n      setNotifications(prev => prev.map(n => n.id === id ? {\n        ...n,\n        is_read: true\n      } : n));\n      setUnreadCount(prev => Math.max(0, prev - 1));\n    } catch (err) {\n      console.error(\"Failed to mark as read\", err);\n    }\n  };\n\n  // Mark all as read\n  const markAllRead = async () => {\n    try {\n      await api.post(\"/notifications/mark-all-read\");\n      setNotifications(prev => prev.map(n => ({\n        ...n,\n        is_read: true\n      })));\n      setUnreadCount(0);\n    } catch (err) {\n      console.error(\"Failed to mark all as read\", err);\n    }\n  };\n\n  // Auto-refresh logic\n  useEffect(() => {\n    if (!user) return;\n\n    // Initial fetch\n    fetchUnreadCount();\n\n    // Poll every 20 seconds\n    const interval = setInterval(() => {\n      fetchUnreadCount();\n    }, 20000);\n    return () => clearInterval(interval);\n  }, [user, fetchUnreadCount]);\n  return /*#__PURE__*/_jsxDEV(NotificationContext.Provider, {\n    value: {\n      notifications,\n      unreadCount,\n      loading,\n      error,\n      fetchNotifications,\n      fetchUnreadCount,\n      markRead,\n      markAllRead\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 9\n  }, this);\n};\n_s2(NotificationProvider, \"Z3Dzvmhm60u/1TvPEPyHkegqmpg=\", false, function () {\n  return [useAuth];\n});\n_c = NotificationProvider;\nvar _c;\n$RefreshReg$(_c, \"NotificationProvider\");","map":{"version":3,"names":["createContext","useContext","useState","useEffect","useCallback","api","useAuth","jsxDEV","_jsxDEV","NotificationContext","useNotifications","_s","NotificationProvider","children","_s2","user","notifications","setNotifications","unreadCount","setUnreadCount","loading","setLoading","error","setError","fetchNotifications","response","get","data","err","console","fetchUnreadCount","unread","markRead","id","post","prev","map","n","is_read","Math","max","markAllRead","interval","setInterval","clearInterval","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/wamp64/www/hrms/frontend-react/src/context/NotificationContext.js"],"sourcesContent":["import { createContext, useContext, useState, useEffect, useCallback } from \"react\";\r\nimport api from \"../api/axios\";\r\nimport { useAuth } from \"./AuthContext\";\r\n\r\nconst NotificationContext = createContext();\r\n\r\nexport const useNotifications = () => useContext(NotificationContext);\r\n\r\nexport const NotificationProvider = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const [notifications, setNotifications] = useState([]);\r\n    const [unreadCount, setUnreadCount] = useState(0);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n\r\n    // Fetch all notifications\r\n    const fetchNotifications = useCallback(async () => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n        try {\r\n            const response = await api.get(\"/notifications\");\r\n            setNotifications(response.data);\r\n            setError(null);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch notifications\", err);\r\n            setError(\"Failed to load notifications\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [user]);\r\n\r\n    // Fetch only unread count\r\n    const fetchUnreadCount = useCallback(async () => {\r\n        if (!user) return;\r\n        try {\r\n            const response = await api.get(\"/notifications/unread-count\");\r\n            setUnreadCount(response.data.unread);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch unread count\", err);\r\n        }\r\n    }, [user]);\r\n\r\n    // Mark single as read\r\n    const markRead = async (id) => {\r\n        try {\r\n            await api.post(`/notifications/mark-read/${id}`);\r\n            // Update local state\r\n            setNotifications(prev => prev.map(n => n.id === id ? { ...n, is_read: true } : n));\r\n            setUnreadCount(prev => Math.max(0, prev - 1));\r\n        } catch (err) {\r\n            console.error(\"Failed to mark as read\", err);\r\n        }\r\n    };\r\n\r\n    // Mark all as read\r\n    const markAllRead = async () => {\r\n        try {\r\n            await api.post(\"/notifications/mark-all-read\");\r\n            setNotifications(prev => prev.map(n => ({ ...n, is_read: true })));\r\n            setUnreadCount(0);\r\n        } catch (err) {\r\n            console.error(\"Failed to mark all as read\", err);\r\n        }\r\n    };\r\n\r\n    // Auto-refresh logic\r\n    useEffect(() => {\r\n        if (!user) return;\r\n\r\n        // Initial fetch\r\n        fetchUnreadCount();\r\n\r\n        // Poll every 20 seconds\r\n        const interval = setInterval(() => {\r\n            fetchUnreadCount();\r\n        }, 20000);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [user, fetchUnreadCount]);\r\n\r\n    return (\r\n        <NotificationContext.Provider value={{\r\n            notifications,\r\n            unreadCount,\r\n            loading,\r\n            error,\r\n            fetchNotifications,\r\n            fetchUnreadCount,\r\n            markRead,\r\n            markAllRead\r\n        }}>\r\n            {children}\r\n        </NotificationContext.Provider>\r\n    );\r\n};\r\n"],"mappings":";;;AAAA,SAASA,aAAa,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AACnF,OAAOC,GAAG,MAAM,cAAc;AAC9B,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,mBAAmB,gBAAGT,aAAa,CAAC,CAAC;AAE3C,OAAO,MAAMU,gBAAgB,GAAGA,CAAA;EAAAC,EAAA;EAAA,OAAMV,UAAU,CAACQ,mBAAmB,CAAC;AAAA;AAACE,EAAA,CAAzDD,gBAAgB;AAE7B,OAAO,MAAME,oBAAoB,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAClD,MAAM;IAAEC;EAAK,CAAC,GAAGT,OAAO,CAAC,CAAC;EAC1B,MAAM,CAACU,aAAa,EAAEC,gBAAgB,CAAC,GAAGf,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACgB,WAAW,EAAEC,cAAc,CAAC,GAAGjB,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAACkB,OAAO,EAAEC,UAAU,CAAC,GAAGnB,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACoB,KAAK,EAAEC,QAAQ,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;;EAExC;EACA,MAAMsB,kBAAkB,GAAGpB,WAAW,CAAC,YAAY;IAC/C,IAAI,CAACW,IAAI,EAAE;IACXM,UAAU,CAAC,IAAI,CAAC;IAChB,IAAI;MACA,MAAMI,QAAQ,GAAG,MAAMpB,GAAG,CAACqB,GAAG,CAAC,gBAAgB,CAAC;MAChDT,gBAAgB,CAACQ,QAAQ,CAACE,IAAI,CAAC;MAC/BJ,QAAQ,CAAC,IAAI,CAAC;IAClB,CAAC,CAAC,OAAOK,GAAG,EAAE;MACVC,OAAO,CAACP,KAAK,CAAC,+BAA+B,EAAEM,GAAG,CAAC;MACnDL,QAAQ,CAAC,8BAA8B,CAAC;IAC5C,CAAC,SAAS;MACNF,UAAU,CAAC,KAAK,CAAC;IACrB;EACJ,CAAC,EAAE,CAACN,IAAI,CAAC,CAAC;;EAEV;EACA,MAAMe,gBAAgB,GAAG1B,WAAW,CAAC,YAAY;IAC7C,IAAI,CAACW,IAAI,EAAE;IACX,IAAI;MACA,MAAMU,QAAQ,GAAG,MAAMpB,GAAG,CAACqB,GAAG,CAAC,6BAA6B,CAAC;MAC7DP,cAAc,CAACM,QAAQ,CAACE,IAAI,CAACI,MAAM,CAAC;IACxC,CAAC,CAAC,OAAOH,GAAG,EAAE;MACVC,OAAO,CAACP,KAAK,CAAC,8BAA8B,EAAEM,GAAG,CAAC;IACtD;EACJ,CAAC,EAAE,CAACb,IAAI,CAAC,CAAC;;EAEV;EACA,MAAMiB,QAAQ,GAAG,MAAOC,EAAE,IAAK;IAC3B,IAAI;MACA,MAAM5B,GAAG,CAAC6B,IAAI,CAAC,4BAA4BD,EAAE,EAAE,CAAC;MAChD;MACAhB,gBAAgB,CAACkB,IAAI,IAAIA,IAAI,CAACC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACJ,EAAE,KAAKA,EAAE,GAAG;QAAE,GAAGI,CAAC;QAAEC,OAAO,EAAE;MAAK,CAAC,GAAGD,CAAC,CAAC,CAAC;MAClFlB,cAAc,CAACgB,IAAI,IAAII,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEL,IAAI,GAAG,CAAC,CAAC,CAAC;IACjD,CAAC,CAAC,OAAOP,GAAG,EAAE;MACVC,OAAO,CAACP,KAAK,CAAC,wBAAwB,EAAEM,GAAG,CAAC;IAChD;EACJ,CAAC;;EAED;EACA,MAAMa,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC5B,IAAI;MACA,MAAMpC,GAAG,CAAC6B,IAAI,CAAC,8BAA8B,CAAC;MAC9CjB,gBAAgB,CAACkB,IAAI,IAAIA,IAAI,CAACC,GAAG,CAACC,CAAC,KAAK;QAAE,GAAGA,CAAC;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC,CAAC,CAAC;MAClEnB,cAAc,CAAC,CAAC,CAAC;IACrB,CAAC,CAAC,OAAOS,GAAG,EAAE;MACVC,OAAO,CAACP,KAAK,CAAC,4BAA4B,EAAEM,GAAG,CAAC;IACpD;EACJ,CAAC;;EAED;EACAzB,SAAS,CAAC,MAAM;IACZ,IAAI,CAACY,IAAI,EAAE;;IAEX;IACAe,gBAAgB,CAAC,CAAC;;IAElB;IACA,MAAMY,QAAQ,GAAGC,WAAW,CAAC,MAAM;MAC/Bb,gBAAgB,CAAC,CAAC;IACtB,CAAC,EAAE,KAAK,CAAC;IAET,OAAO,MAAMc,aAAa,CAACF,QAAQ,CAAC;EACxC,CAAC,EAAE,CAAC3B,IAAI,EAAEe,gBAAgB,CAAC,CAAC;EAE5B,oBACItB,OAAA,CAACC,mBAAmB,CAACoC,QAAQ;IAACC,KAAK,EAAE;MACjC9B,aAAa;MACbE,WAAW;MACXE,OAAO;MACPE,KAAK;MACLE,kBAAkB;MAClBM,gBAAgB;MAChBE,QAAQ;MACRS;IACJ,CAAE;IAAA5B,QAAA,EACGA;EAAQ;IAAAkC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACiB,CAAC;AAEvC,CAAC;AAACpC,GAAA,CAtFWF,oBAAoB;EAAA,QACZN,OAAO;AAAA;AAAA6C,EAAA,GADfvC,oBAAoB;AAAA,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}