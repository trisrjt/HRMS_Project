"use strict";(self.webpackChunkfrontend_react=self.webpackChunkfrontend_react||[]).push([[921],{5921:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(9379),s=r(5043),d=r(1321),n=r(1291),o=r(9419),l=r(6036),i=r(3318),c=r(2023),x=(r(6433),r(228)),g=r.n(x),u=r(579);delete g().Icon.Default.prototype._getIconUrl,g().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const h=e=>{let{children:t,className:r}=e;return(0,u.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 transition-colors duration-200 ".concat(r),children:t})},m=e=>{let{children:t}=e;return(0,u.jsx)("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700",children:t})},b=e=>{let{children:t,className:r}=e;return(0,u.jsx)("div",{className:"p-6 ".concat(r),children:t})},y=e=>{let{children:t}=e;return(0,u.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white m-0",children:t})},k=e=>{let{children:t,onClick:r,disabled:a,variant:s="primary",className:d}=e;return(0,u.jsx)("button",{onClick:r,disabled:a,className:"px-5 py-2.5 rounded-lg font-medium text-sm transition-all duration-200 flex items-center justify-center ".concat({primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-md hover:shadow-lg disabled:bg-blue-300 disabled:shadow-none",success:"bg-emerald-600 hover:bg-emerald-700 text-white shadow-md hover:shadow-lg disabled:bg-emerald-300 disabled:shadow-none",outline:"bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50",destructive:"bg-red-600 hover:bg-red-700 text-white shadow-md hover:shadow-lg disabled:bg-red-300 disabled:shadow-none"}[s]," ").concat(a?"cursor-not-allowed":"cursor-pointer"," ").concat(d),children:t})},p=e=>{let{children:t,variant:r="error"}=e;return(0,u.jsx)("div",{className:"p-4 rounded-lg mb-4 text-sm border ".concat("error"===r?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-400":"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-700 dark:text-emerald-400"),children:t})},v=e=>{let{children:t,variant:r="default"}=e;const a={default:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",success:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400",danger:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",warning:"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400",Present:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400",Absent:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",Late:"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400","Half Day":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},s=a[r]||a.default;return(0,u.jsx)("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-semibold ".concat(s),children:t})},f=()=>{const[e,t]=(0,s.useState)([]),[r,x]=(0,s.useState)(!0),[g,f]=(0,s.useState)(null),[j,w]=(0,s.useState)(null),[N,_]=(0,s.useState)(null),[S,C]=(0,s.useState)(!1),[O,A]=(0,s.useState)(!1),[I,P]=(0,s.useState)(null),[L,D]=(0,s.useState)(!1),[F,E]=(0,s.useState)(null),[T,U]=(0,s.useState)(!1),[M,q]=(0,s.useState)([]),[R,H]=(0,s.useState)(!1),[G,W]=(0,s.useState)(!1),Y="undefined"!==typeof window&&window.isSecureContext,[z,B]=(0,s.useState)((new Date).toISOString().slice(0,7)),V=async()=>{try{f(null);const e=await d.A.get("/my-attendance"),r=e.data.data||e.data;t(Array.isArray(r)?r:[])}catch(e){console.error("Fetch error:",e),f("Failed to load attendance records. Please try again later.")}finally{x(!1)}};(0,s.useEffect)(()=>{V()},[]),(0,s.useEffect)(()=>{if(N||j){const e=setTimeout(()=>{_(null),w(null)},3e3);return()=>clearTimeout(e)}},[N,j]),(0,s.useEffect)(()=>(document.body.style.overflow=L?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[L]);const K=()=>new Promise((e,t)=>{var r;if(Y){if(console.log("\ud83d\udd0d Checking geolocation support..."),!navigator.geolocation)return console.error("\u274c Geolocation not supported"),void t(new Error("Geolocation is not supported by your browser. Please use a modern browser to check in."));console.log("\u2705 Geolocation supported, requesting permission..."),null!==(r=navigator.permissions)&&void 0!==r&&r.query&&navigator.permissions.query({name:"geolocation"}).then(e=>{console.log("\ud83e\udded Geolocation permission state:",e.state)}).catch(e=>{console.log("\ud83e\udded Geolocation permission query failed:",e)}),navigator.geolocation.getCurrentPosition(t=>{console.log("\u2705 Location obtained:",t.coords);const r={latitude:t.coords.latitude,longitude:t.coords.longitude};P(r),e(r)},e=>{console.error("\u274c Location error:",e.code,e.message);let r="Location access denied. Please allow location access to check in.";e.code===e.PERMISSION_DENIED?r="Location permission denied. You must allow location access to check in/out.":e.code===e.POSITION_UNAVAILABLE?r="Location information unavailable. Please try again.":e.code===e.TIMEOUT&&(r="Location request timed out. Please try again."),t(new Error(r))},{timeout:15e3,enableHighAccuracy:!0,maximumAge:0})}else t(new Error("Location requires a secure context. Open the app on http://localhost:3000 (or use HTTPS)."))}),Z=()=>{const e=navigator.userAgent;let t="Desktop";/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?t="Tablet":/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)&&(t="Mobile");let r="Unknown";e.indexOf("Firefox")>-1?r="Firefox":e.indexOf("Chrome")>-1?r="Chrome":e.indexOf("Safari")>-1?r="Safari":e.indexOf("Edge")>-1?r="Edge":(e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1)&&(r="IE");let a=localStorage.getItem("device_id");return a||(a="device_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem("device_id",a)),{device_id:a,device_type:t,browser:r}},J=(new Date).toISOString().split("T")[0],Q=e.find(e=>new Date(e.date).toISOString().split("T")[0]===J),X=!(null===Q||void 0===Q||!Q.check_in),$=!(null===Q||void 0===Q||!Q.check_out),ee=!(null===Q||void 0===Q||!Q.overtime_start),te=!(null===Q||void 0===Q||!Q.overtime_end),re=(0,n.xN)(e),ae=(0,n.P2)(e,z),se=e.filter(e=>e.date.startsWith(z));return r?(0,u.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-50 dark:bg-gray-900 text-gray-500 dark:text-gray-400 transition-colors",children:(0,u.jsx)("div",{className:"text-xl font-medium animate-pulse",children:"Loading attendance..."})}):(0,u.jsxs)("div",{className:"p-6 max-w-[1200px] mx-auto bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-200",children:[(0,u.jsxs)("div",{className:"flex flex-col gap-6 mb-8",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[(0,u.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Attendance"}),(0,u.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,u.jsx)(k,{onClick:async()=>{console.log("\ud83d\udd35 Check-in button clicked");const t=(new Date).toISOString().split("T")[0],r=e.find(e=>new Date(e.date).toISOString().split("T")[0]===t);if(null!==r&&void 0!==r&&r.check_in)w("You have already checked in today.");else try{E("check-in"),w(null),console.log("\ud83d\udccd Requesting location for check-in...");const e=await K();console.log("\u2705 Location received:",e);const t=await d.A.post("/my-attendance/check-in",(0,a.A)({latitude:e.latitude,longitude:e.longitude},Z()));if(t.data.requires_action&&t.data.pending_checkouts)return console.log("\u26a0\ufe0f Pending checkouts detected:",t.data.pending_checkouts),q(t.data.pending_checkouts),U(!0),void P(e);D(!0)}catch(l){var s,n,o;if(console.error("\u274c Check-in error:",l),409===(null===l||void 0===l||null===(s=l.response)||void 0===s?void 0:s.status))w((null===l||void 0===l||null===(n=l.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message)||"Already checked in today.");else w((null===l||void 0===l?void 0:l.message)||"Location access denied. In Brave: click the icon near the URL \u2192 Site settings \u2192 Location \u2192 Allow");E(null)}},disabled:S||X,variant:"success",children:S?"Checking In...":X?"Checked In":"Check In"}),(0,u.jsx)(k,{onClick:async()=>{console.log("\ud83d\udd34 Check-out button clicked"),w(null),console.log("\ud83d\udd34 Getting location for check-out...");try{const e=await K();console.log("\u2705 Location obtained:",e),P(e),E("check-out"),D(!0)}catch(g){console.error("\u274c Location error:",g),w(g.message||"Failed to get your location. Please enable location services.")}},disabled:O||!X||$,variant:"destructive",children:O?"Checking Out...":$?"Checked Out":"Check Out"}),$&&!te&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(k,{onClick:async()=>{try{H(!0),w(null),await d.A.post("/my-attendance/overtime/start"),_("Overtime started successfully!"),await V()}catch(r){var e,t;console.error("Start overtime error:",r),w((null===r||void 0===r||null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to start overtime. Please try again.")}finally{H(!1)}},disabled:R||ee,variant:"primary",className:"bg-purple-600 hover:bg-purple-700",children:R?"Starting...":ee?"OT Started":"Start Overtime"}),ee&&(0,u.jsx)(k,{onClick:async()=>{try{W(!0),w(null),await d.A.post("/my-attendance/overtime/end"),_("Overtime ended successfully!"),await V()}catch(r){var e,t;console.error("End overtime error:",r),w((null===r||void 0===r||null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to end overtime. Please try again.")}finally{W(!1)}},disabled:G,variant:"primary",className:"bg-orange-600 hover:bg-orange-700",children:G?"Ending...":"End Overtime"})]})]})]}),j&&(0,u.jsxs)(p,{variant:"error",children:[(0,u.jsx)("strong",{children:"Error:"})," ",j]}),N&&(0,u.jsxs)(p,{variant:"success",children:[(0,u.jsx)("strong",{children:"Success:"})," ",N]}),g&&(0,u.jsx)(p,{variant:"error",children:g})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,u.jsxs)("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm transition-colors duration-200",children:[(0,u.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2 font-medium uppercase tracking-wide",children:"This Week"}),(0,u.jsxs)("div",{className:"flex items-baseline gap-2 mb-4",children:[(0,u.jsx)("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:re.formatted||"0h 0m"}),(0,u.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"worked"})]}),(0,u.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 dark:text-gray-400 border-t border-gray-100 dark:border-gray-700 pt-4",children:[(0,u.jsxs)("span",{children:["Days: ",(0,u.jsx)("strong",{className:"text-gray-700 dark:text-gray-300",children:re.daysWorked||0})]}),(0,u.jsxs)("span",{children:["Avg: ",(0,u.jsx)("strong",{className:"text-gray-700 dark:text-gray-300",children:re.average||"0h"})," / day"]})]})]}),(0,u.jsxs)("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm transition-colors duration-200",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,u.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium uppercase tracking-wide",children:"Monthly Overview"}),(0,u.jsx)("input",{type:"month",id:"month-filter",name:"month-filter",value:z,onChange:e=>B(e.target.value),className:"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm px-3 py-1 rounded border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,u.jsxs)("div",{className:"flex items-baseline gap-2 mb-4",children:[(0,u.jsx)("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:ae.formatted||"0h 0m"}),(0,u.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"worked"})]}),(0,u.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 dark:text-gray-400 border-t border-gray-100 dark:border-gray-700 pt-4",children:[(0,u.jsxs)("span",{children:["Days: ",(0,u.jsx)("strong",{className:"text-gray-700 dark:text-gray-300",children:ae.daysWorked||0})]}),(0,u.jsxs)("span",{children:["Avg: ",(0,u.jsx)("strong",{className:"text-gray-700 dark:text-gray-300",children:ae.average||"0h"})," / day"]})]})]})]}),(0,u.jsxs)(h,{className:"overflow-hidden",children:[(0,u.jsx)(m,{children:(0,u.jsxs)(y,{children:["Attendance History (",new Date(z+"-01").toLocaleString("default",{month:"long",year:"numeric"}),")"]})}),(0,u.jsx)(b,{className:"p-0",children:(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,u.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Check In"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Check Out"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Hours"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Overtime"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Location"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Device"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,u.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Remarks"})]})}),(0,u.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:se.length>0?se.map(e=>(0,u.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[(0,u.jsx)("td",{className:"p-4 text-sm font-medium text-gray-900 dark:text-white",children:new Date(e.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),(0,u.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:(0,u.jsxs)("div",{className:"flex flex-col",children:[(0,u.jsx)("span",{children:e.check_in?(0,n.fU)(e.check_in,e.date):"--:--"}),e.check_in_latitude&&e.check_in_longitude&&(0,u.jsx)("a",{href:"https://www.google.com/maps?q=".concat(e.check_in_latitude,",").concat(e.check_in_longitude),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline mt-1",onClick:e=>e.stopPropagation(),children:"\ud83d\udccd View"})]})}),(0,u.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:(0,u.jsxs)("div",{className:"flex flex-col",children:[(0,u.jsx)("span",{children:e.check_out?(0,n.fU)(e.check_out,e.date):"--:--"}),e.check_out_latitude&&e.check_out_longitude&&(0,u.jsx)("a",{href:"https://www.google.com/maps?q=".concat(e.check_out_latitude,",").concat(e.check_out_longitude),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline mt-1",onClick:e=>e.stopPropagation(),children:"\ud83d\udccd View"})]})}),(0,u.jsx)("td",{className:"p-4 text-sm font-semibold text-indigo-600 dark:text-indigo-400",children:(0,n.w_)(e.check_in,e.check_out)}),(0,u.jsx)("td",{className:"p-4 text-sm",children:e.overtime_start?(0,u.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,u.jsxs)("span",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:["Start: ",(0,n.fU)(e.overtime_start,e.date)]}),e.overtime_end?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("span",{className:"text-xs font-medium text-orange-600 dark:text-orange-400",children:["End: ",(0,n.fU)(e.overtime_end,e.date)]}),(0,u.jsxs)("span",{className:"text-xs font-bold text-green-600 dark:text-green-400",children:[e.overtime_hours,"h OT"]})]}):(0,u.jsx)("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:"\u23f3 In Progress"})]}):(0,u.jsx)("span",{className:"text-gray-400 text-xs",children:"--"})}),(0,u.jsx)("td",{className:"p-4 text-xs text-gray-600 dark:text-gray-400",children:e.check_in_latitude&&e.check_in_longitude?(0,u.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,u.jsxs)("span",{className:"font-medium",children:["In: ",Number(e.check_in_latitude).toFixed(4),", ",Number(e.check_in_longitude).toFixed(4)]}),e.check_out_latitude&&e.check_out_longitude&&(0,u.jsxs)("span",{className:"font-medium",children:["Out: ",Number(e.check_out_latitude).toFixed(4),", ",Number(e.check_out_longitude).toFixed(4)]})]}):(0,u.jsx)("span",{className:"text-gray-400",children:"--"})}),(0,u.jsx)("td",{className:"p-4 text-xs text-gray-600 dark:text-gray-400",children:e.device_id?(0,u.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,u.jsx)("span",{className:"font-medium",children:e.device_type||"Unknown"}),(0,u.jsxs)("span",{className:"text-gray-500 dark:text-gray-500 truncate max-w-[120px]",title:String(e.device_id),children:["ID: ",String(e.device_id).substring(0,12),"..."]}),e.browser&&(0,u.jsx)("span",{className:"text-gray-500 dark:text-gray-500",children:e.browser})]}):(0,u.jsx)("span",{className:"text-gray-400",children:"--"})}),(0,u.jsx)("td",{className:"p-4 text-sm",children:(0,u.jsx)(v,{variant:e.status,children:e.status})}),(0,u.jsx)("td",{className:"p-4 text-xs text-gray-600 dark:text-gray-400",children:(0,u.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,u.jsxs)("span",{className:"font-medium text-green-600 dark:text-green-400",children:["\u2713 Checked in by ",e.checked_in_by||"self"]}),e.check_out&&(0,u.jsxs)("span",{className:"font-medium text-purple-600 dark:text-purple-400",children:["\u2713 Checked out by ",e.checked_out_by||"self"]}),!e.check_out&&(0,u.jsx)("span",{className:"text-amber-600 dark:text-amber-400",children:"\u23f3 Pending checkout"})]})})]},e.id)):(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"9",className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"No attendance records found for this month."})})})]})})})]}),L&&(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,u.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-lg w-full",children:[(0,u.jsxs)("div",{className:"p-5 border-b border-gray-200 dark:border-gray-700",children:[(0,u.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"\ud83d\udccd Location Required"}),(0,u.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Confirm your location for attendance tracking"})]}),(0,u.jsxs)("div",{className:"p-5 space-y-4",children:[I&&(0,u.jsxs)("div",{className:"space-y-2",children:[(0,u.jsx)("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Your Current Location:"}),(0,u.jsx)("div",{className:"h-48 rounded-lg overflow-hidden border border-gray-300 dark:border-gray-600",children:(0,u.jsxs)(o.W,{center:[I.latitude,I.longitude],zoom:15,style:{height:"100%",width:"100%"},scrollWheelZoom:!1,children:[(0,u.jsx)(c.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,u.jsx)(l.p,{position:[I.latitude,I.longitude],children:(0,u.jsxs)(i.z,{children:["Your Location",(0,u.jsx)("br",{}),"Lat: ",I.latitude.toFixed(6),(0,u.jsx)("br",{}),"Lng: ",I.longitude.toFixed(6)]})})]})}),(0,u.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["\ud83d\udccc ",I.latitude.toFixed(6),", ",I.longitude.toFixed(6)]})]}),(0,u.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:(0,u.jsxs)("p",{className:"text-xs text-blue-800 dark:text-blue-300",children:[(0,u.jsx)("strong",{children:"\u2139\ufe0f Note:"})," Your location is captured only during check-in/check-out for attendance verification."]})})]}),(0,u.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end",children:[(0,u.jsx)(k,{variant:"outline",onClick:()=>{D(!1),E(null),P(null),C(!1),A(!1)},disabled:S||O,children:"Cancel"}),(0,u.jsx)(k,{variant:"check-out"===F?"destructive":"success",onClick:"check-out"===F?async()=>{try{A(!0),D(!1);await d.A.post("/my-attendance/check-out",{check_out_latitude:I.latitude,check_out_longitude:I.longitude});_("Successfully checked out! \ud83d\udc4b"),await V()}catch(g){var e,t,r,a;if(console.error("Checkout error:",g),"checkout_restricted"===(null===(e=g.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error))w(g.response.data.message||"Checkout is not allowed after 9:00 PM. Please contact HR/Admin/SuperAdmin.");else w((null===(r=g.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to check out. Please try again.")}finally{A(!1),E(null),P(null)}}:async()=>{try{C(!0),w(null),D(!1);const e=Z(),t=(0,a.A)({latitude:I.latitude,longitude:I.longitude,force_checkin:!0},e);await d.A.post("/my-attendance/check-in",t),_("Checked in successfully at your current location!"),await V()}catch(r){var e,t;console.error("Check-in error:",r),w((null===r||void 0===r?void 0:r.message)||(null===r||void 0===r||null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to check in.")}finally{C(!1),E(null),P(null)}},disabled:S||O,children:S||O?"Processing...":"check-out"===F?"Confirm Check Out":"Confirm Check In"})]})]})}),T&&(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,u.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,u.jsxs)("div",{className:"p-5 border-b border-gray-200 dark:border-gray-700",children:[(0,u.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"\u26a0\ufe0f Pending Check-Outs Detected"}),(0,u.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["You have ",M.length," session",M.length>1?"s":""," without check-out. Contact HR/Admin for checkout or proceed with new check-in."]})]}),(0,u.jsxs)("div",{className:"p-5",children:[(0,u.jsx)("div",{className:"space-y-3",children:M.map(e=>(0,u.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,u.jsxs)("div",{className:"flex justify-between items-start",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:["\ud83d\udcc5 ",new Date(e.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),(0,u.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Check-in: ",(0,u.jsx)("span",{className:"font-medium text-green-600 dark:text-green-400",children:e.check_in})]}),e.check_in_latitude&&e.check_in_longitude&&(0,u.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["\ud83d\udccd ",Number(e.check_in_latitude).toFixed(4),", ",Number(e.check_in_longitude).toFixed(4)]})]}),(0,u.jsx)(v,{variant:"warning",children:"Pending"})]})},e.id))}),(0,u.jsx)("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3 mt-4",children:(0,u.jsxs)("p",{className:"text-xs text-amber-800 dark:text-amber-300",children:[(0,u.jsx)("strong",{children:"\u2139\ufe0f Note:"})," Employees cannot check themselves out. Please contact HR or Admin to complete these checkouts, or proceed with a new check-in. Unchecked sessions will be automatically checked out at midnight."]})})]}),(0,u.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end",children:[(0,u.jsx)(k,{variant:"outline",onClick:()=>{U(!1),q([]),E(null),P(null)},children:"Cancel"}),(0,u.jsx)(k,{variant:"success",onClick:async()=>{try{C(!0),w(null),U(!1);const e=Z(),t=(0,a.A)({latitude:I.latitude,longitude:I.longitude,force_checkin:!0},e);await d.A.post("/my-attendance/check-in",t),_("Checked in successfully! Don't forget to check out your pending sessions."),await V()}catch(r){var e,t;console.error("Force check-in error:",r),w((null===r||void 0===r?void 0:r.message)||(null===r||void 0===r||null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to check in.")}finally{C(!1),E(null),P(null),q([])}},children:"Proceed with Check In"})]})]})})]})}}}]);
//# sourceMappingURL=921.5cc841c6.chunk.js.map