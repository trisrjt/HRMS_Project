/*! For license information please see 327.8537c9d4.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend_react=self.webpackChunkfrontend_react||[]).push([[327],{4327:(e,a,r)=>{r.r(a),r.d(a,{default:()=>k});var t=r(9379),s=r(5043),d=r(8163),l=r(9778),n=r(9570),i=r(6446),o=r(7719),c=r(2054);const x=(0,r(7784).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var g=r(614),m=r(579);const y=e=>{let{isOpen:a,onClose:r,onConfirm:t,title:s="Confirm Action",message:d="Are you sure you want to proceed?",confirmText:l="Confirm",cancelText:y="Cancel",variant:b="warning"}=e;if(!a)return null;const u={danger:{icon:(0,m.jsx)(o.A,{className:"w-6 h-6 text-red-600"}),buttonBg:"bg-red-600 hover:bg-red-700",iconBg:"bg-red-100 dark:bg-red-900/30"},warning:{icon:(0,m.jsx)(o.A,{className:"w-6 h-6 text-yellow-600"}),buttonBg:"bg-yellow-600 hover:bg-yellow-700",iconBg:"bg-yellow-100 dark:bg-yellow-900/30"},success:{icon:(0,m.jsx)(c.A,{className:"w-6 h-6 text-green-600"}),buttonBg:"bg-green-600 hover:bg-green-700",iconBg:"bg-green-100 dark:bg-green-900/30"},info:{icon:(0,m.jsx)(x,{className:"w-6 h-6 text-blue-600"}),buttonBg:"bg-blue-600 hover:bg-blue-700",iconBg:"bg-blue-100 dark:bg-blue-900/30"}},h=u[b]||u.warning;return(0,m.jsx)(n.N,{children:(0,m.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,m.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),(0,m.jsx)(i.P.div,{initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},className:"relative w-full max-w-md bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:(0,m.jsxs)("div",{className:"p-6",children:[(0,m.jsxs)("div",{className:"flex items-start gap-4",children:[(0,m.jsx)("div",{className:"p-3 rounded-full flex-shrink-0 ".concat(h.iconBg),children:h.icon}),(0,m.jsxs)("div",{className:"flex-1",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:s}),(0,m.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 leading-relaxed",children:d})]}),(0,m.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:(0,m.jsx)(g.A,{className:"w-5 h-5"})})]}),(0,m.jsxs)("div",{className:"mt-8 flex items-center justify-end gap-3",children:[(0,m.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:y}),(0,m.jsx)("button",{onClick:()=>{t(),r()},className:"px-4 py-2 text-sm font-medium text-white rounded-lg shadow-sm transition-all shadow-md active:scale-95 ".concat(h.buttonBg),children:l})]})]})})]})})},b=e=>{let{children:a,onClick:r,disabled:t,variant:s="primary",className:d,type:l="button"}=e;return(0,m.jsx)("button",{type:l,onClick:r,disabled:t,className:"px-5 py-2.5 rounded-lg font-medium text-sm transition-all duration-200 flex items-center justify-center ".concat({primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-md hover:shadow-lg disabled:bg-blue-300 disabled:shadow-none",secondary:"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50",destructive:"bg-red-600 hover:bg-red-700 text-white shadow-md hover:shadow-lg disabled:bg-red-300 disabled:shadow-none"}[s]," ").concat(t?"cursor-not-allowed":"cursor-pointer"," ").concat(d),children:a})},u=e=>{let{children:a,className:r}=e;return(0,m.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 transition-colors duration-200 ".concat(r),children:a})},h=e=>{let{children:a,variant:r="error"}=e;return(0,m.jsx)("div",{className:"p-4 rounded-lg mb-4 text-sm border ".concat("error"===r?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-400":"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-700 dark:text-emerald-400"),children:a})},p=e=>{let{children:a,variant:r="default"}=e;const t={default:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",Approved:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400",Rejected:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",Pending:"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400",Withdrawn:"bg-gray-200 text-gray-600 dark:bg-gray-600 dark:text-gray-300","Partially Approved":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},s=t[r]||t.default;return(0,m.jsx)("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-semibold ".concat(s),children:a})},v=e=>{let{isOpen:a,onClose:r,title:t,children:s}=e;return a?(0,m.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm p-4",children:(0,m.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg shadow-2xl transform transition-all border border-gray-200 dark:border-gray-700",children:[(0,m.jsxs)("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[(0,m.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t}),(0,m.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors bg-transparent border-none cursor-pointer text-2xl leading-none",children:"\xd7"})]}),(0,m.jsx)("div",{className:"p-6",children:s})]})}):null},k=()=>{const e=(0,d.Zp)(),[a,r]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[o,c]=(0,s.useState)(!0),[x,g]=(0,s.useState)(null),[k,f]=(0,s.useState)(!1),[j,w]=(0,s.useState)(!1),[N,_]=(0,s.useState)(null),[A,C]=(0,s.useState)(null),[S,D]=(0,s.useState)({leave_type_id:"",start_date:"",end_date:"",reason:""}),[F,L]=(0,s.useState)([]),P=async()=>{try{const e=await l.A.get("/my-leaves/balances");L(e.data||[])}catch(e){console.error("Fetch balances error:",e)}},[B,T]=(0,s.useState)(null),q=async()=>{try{const e=await l.A.get("/my-leaves"),a=e.data.data||e.data;r(Array.isArray(a)?a:[])}catch(e){console.error("Fetch leaves error:",e),g("Failed to load leave history.")}},O=async()=>{try{const e=await l.A.get("/my-leaves/types");i(e.data||[])}catch(e){console.error("Fetch leave types error:",e)}},[E,R]=(0,s.useState)({isOpen:!1,title:"",message:"",onConfirm:()=>{},variant:"warning"});(0,s.useEffect)(()=>{(async()=>{c(!0),await Promise.all([q(),P(),O()]),await(async()=>{try{const e=await l.A.get("/user");T(e.data)}catch(e){console.error("Fetch profile error:",e)}})(),c(!1)})();const e=setInterval(()=>{q(),P()},1e4);return()=>clearInterval(e)},[]);const M=e=>{const{name:a,value:r}=e.target;D(e=>(0,t.A)((0,t.A)({},e),{},{[a]:r}))},W=async e=>{!function(e,a,r){R({isOpen:!0,title:e,message:a,onConfirm:r,variant:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"warning"})}("Withdraw Leave Request","Are you sure you want to withdraw this leave request? This action cannot be undone.",async()=>{try{await l.A.put("/leaves/".concat(e,"/withdraw")),C("Leave withdrawn successfully."),q(),P(),setTimeout(()=>C(null),3e3)}catch(t){var a,r;console.error("Withdraw error:",t),g((null===t||void 0===t||null===(a=t.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to withdraw leave."),setTimeout(()=>g(null),3e3)}},"danger")};return o?(0,m.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-50 dark:bg-gray-900 text-gray-500 dark:text-gray-400 transition-colors",children:(0,m.jsx)("div",{className:"text-xl font-medium animate-pulse",children:"Loading leaves..."})}):(0,m.jsxs)("div",{className:"p-6 max-w-[1200px] mx-auto bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-200",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Leaves"}),(0,m.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your leave applications"})]}),(0,m.jsxs)("div",{className:"flex gap-4",children:[(0,m.jsx)(b,{variant:"secondary",onClick:()=>e("/employee/dashboard"),children:"Back to Dashboard"}),(0,m.jsx)(b,{onClick:()=>f(!0),children:"Apply Leave"})]})]}),(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:F.map(e=>{var a;return(0,m.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,m.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium mb-1",children:(null===(a=e.leave_type)||void 0===a?void 0:a.name)||"Leave"}),(0,m.jsxs)("div",{className:"flex items-baseline gap-1 mt-1",children:[(0,m.jsx)("span",{className:"text-2xl font-bold ".concat(e.remaining_days>0?"text-gray-900 dark:text-white":"text-red-600 dark:text-red-400"),children:e.remaining_days}),(0,m.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"days available"})]}),(0,m.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700 text-xs flex justify-between text-gray-400 dark:text-gray-500",children:[(0,m.jsxs)("span",{children:["Allocated: ",e.allocated_days]}),(0,m.jsxs)("span",{children:["Used: ",e.used_days]})]})]},e.id)})}),x&&(0,m.jsx)(h,{variant:"error",children:x}),A&&(0,m.jsxs)(h,{variant:"success",children:[(0,m.jsx)("strong",{children:"Success:"})," ",A]}),(0,m.jsx)(u,{className:"overflow-hidden",children:(0,m.jsx)("div",{className:"overflow-x-auto",children:(0,m.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,m.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),(0,m.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Dates & Duration"}),(0,m.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason"}),(0,m.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,m.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Approved By"})]})}),(0,m.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.length>0?a.map(e=>{var a;const r=new Date(e.start_date),t=new Date(e.end_date),s=e.days?parseFloat(e.days):(t-r)/864e5+1,d=e.approved_days?s-e.approved_days:0;return(0,m.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[(0,m.jsx)("td",{className:"p-4 text-sm font-medium text-gray-900 dark:text-white",children:(null===(a=e.leave_type)||void 0===a?void 0:a.name)||"Leave"}),(0,m.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:(0,m.jsxs)("div",{className:"flex flex-col",children:[(0,m.jsxs)("span",{className:"font-medium",children:[new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString()]}),(0,m.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:["Requested: ",s," days"]}),"Partially Approved"===e.status&&e.approved_days&&(0,m.jsxs)("div",{className:"flex flex-col gap-0.5 mt-1 border-l-2 border-blue-200 pl-2",children:[(0,m.jsxs)("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:["Approved: ",e.approved_days," days"]}),(0,m.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Returned: ",d," days"]})]})]})}),(0,m.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300 max-w-xs truncate",children:e.reason}),(0,m.jsx)("td",{className:"p-4 text-sm",children:(0,m.jsxs)("div",{className:"flex items-center gap-3",children:[(0,m.jsx)(p,{variant:e.status,children:e.status}),("Pending"===e.status||"Pending_Email_Failed"===e.status)&&e.start_date>=(new Date).toISOString().split("T")[0]&&(0,m.jsx)("button",{onClick:()=>W(e.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-xs rounded transition-colors shadow-sm font-medium",children:"Withdraw"})]})}),(0,m.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:e.approver?(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"font-medium",children:e.approver.name}),(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:1===e.approver.role_id?"SuperAdmin":2===e.approver.role_id?"Admin":3===e.approver.role_id?"HR":"Employee"})]}):(0,m.jsx)("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"-"})})]},e.id)}):(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:"5",className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"No leave applications found."})})})]})})}),(0,m.jsxs)(v,{isOpen:k,onClose:()=>f(!1),title:"Apply for Leave",children:[N&&(0,m.jsx)(h,{variant:"error",children:N}),(0,m.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),_(null);const a=(()=>{if(!S.leave_type_id)return"Please select a leave type.";if(!S.start_date)return"Start date is required.";if(!S.end_date)return"End date is required.";const[e,a,r]=S.start_date.split("-").map(Number),t=new Date(e,a-1,r),s=new Date;return s.setHours(0,0,0,0),t<s?"Start date cannot be in the past. Please select today or a future date.":new Date(S.end_date)<new Date(S.start_date)?"End date cannot be before start date.":S.reason.trim()?null:"Please provide a reason."})();if(a)_(a);else{w(!0);try{await l.A.post("/leaves",S),C("Leave application submitted successfully. Email notification sent."),f(!1),D({leave_type_id:"",start_date:"",end_date:"",reason:""}),await q(),await P(),setTimeout(()=>C(null),3e3)}catch(s){var r,t;console.error("Apply leave error:",s),_((null===s||void 0===s||null===(r=s.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message)||"Failed to submit leave application.")}finally{w(!1)}}},className:"flex flex-col gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"leave_type_id",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Leave Type"}),(0,m.jsxs)("select",{id:"leave_type_id",name:"leave_type_id",value:S.leave_type_id,onChange:M,required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,m.jsx)("option",{value:"",children:"Select Type"}),n.map(e=>(0,m.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"start_date",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Start Date"}),(0,m.jsx)("input",{type:"date",id:"start_date",name:"start_date",value:S.start_date,onChange:M,required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"end_date",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"End Date"}),(0,m.jsx)("input",{type:"date",id:"end_date",name:"end_date",value:S.end_date,onChange:M,required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Reason"}),(0,m.jsx)("textarea",{id:"reason",name:"reason",value:S.reason,onChange:M,rows:"3",required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Please provide a reason for your leave..."})]}),(0,m.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,m.jsx)(b,{variant:"secondary",onClick:()=>f(!1),children:"Cancel"}),(0,m.jsx)(b,{type:"submit",disabled:j,children:j?"Applying...":"Apply Leave"})]})]})]}),(0,m.jsx)(y,{isOpen:E.isOpen,onClose:()=>{R(e=>(0,t.A)((0,t.A)({},e),{},{isOpen:!1}))},onConfirm:E.onConfirm,title:E.title,message:E.message,variant:E.variant,confirmText:"Yes, Proceed",cancelText:"Cancel"})]})}}}]);
//# sourceMappingURL=327.8537c9d4.chunk.js.map