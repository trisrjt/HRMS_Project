"use strict";(self.webpackChunkfrontend_react=self.webpackChunkfrontend_react||[]).push([[778],{3778:(e,a,r)=>{r.r(a),r.d(a,{default:()=>y});var t=r(9379),d=r(5043),s=r(8163),l=r(1321),n=r(579);const i=e=>{let{children:a,onClick:r,disabled:t,variant:d="primary",className:s,type:l="button"}=e;return(0,n.jsx)("button",{type:l,onClick:r,disabled:t,className:"px-5 py-2.5 rounded-lg font-medium text-sm transition-all duration-200 flex items-center justify-center ".concat({primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-md hover:shadow-lg disabled:bg-blue-300 disabled:shadow-none",secondary:"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50",destructive:"bg-red-600 hover:bg-red-700 text-white shadow-md hover:shadow-lg disabled:bg-red-300 disabled:shadow-none"}[d]," ").concat(t?"cursor-not-allowed":"cursor-pointer"," ").concat(s),children:a})},o=e=>{let{children:a,className:r}=e;return(0,n.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 transition-colors duration-200 ".concat(r),children:a})},c=e=>{let{children:a,variant:r="error"}=e;return(0,n.jsx)("div",{className:"p-4 rounded-lg mb-4 text-sm border ".concat("error"===r?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-400":"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-700 dark:text-emerald-400"),children:a})},x=e=>{let{children:a,variant:r="default"}=e;const t={default:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",Approved:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400",Rejected:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",Pending:"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400",Withdrawn:"bg-gray-200 text-gray-600 dark:bg-gray-600 dark:text-gray-300","Partially Approved":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},d=t[r]||t.default;return(0,n.jsx)("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-semibold ".concat(d),children:a})},g=e=>{let{isOpen:a,onClose:r,title:t,children:d}=e;return a?(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm p-4",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg shadow-2xl transform transition-all border border-gray-200 dark:border-gray-700",children:[(0,n.jsxs)("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[(0,n.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t}),(0,n.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors bg-transparent border-none cursor-pointer text-2xl leading-none",children:"\xd7"})]}),(0,n.jsx)("div",{className:"p-6",children:d})]})}):null},y=()=>{const e=(0,s.Zp)(),[a,r]=(0,d.useState)([]),[y,m]=(0,d.useState)([]),[b,u]=(0,d.useState)(!0),[h,p]=(0,d.useState)(null),[v,k]=(0,d.useState)(!1),[j,f]=(0,d.useState)(!1),[w,N]=(0,d.useState)(null),[_,A]=(0,d.useState)(null),[S,C]=(0,d.useState)({leave_type_id:"",start_date:"",end_date:"",reason:""}),[D,L]=(0,d.useState)([]),F=async()=>{try{const e=await l.A.get("/my-leaves/balances");L(e.data||[])}catch(e){console.error("Fetch balances error:",e)}},q=async()=>{try{const e=await l.A.get("/my-leaves"),a=e.data.data||e.data;r(Array.isArray(a)?a:[])}catch(e){console.error("Fetch leaves error:",e),p("Failed to load leave history.")}},P=async()=>{try{const e=await l.A.get("/my-leaves/types");m(e.data||[])}catch(e){console.error("Fetch leave types error:",e)}};(0,d.useEffect)(()=>{(async()=>{u(!0),await Promise.all([q(),F(),P()]),u(!1)})();const e=setInterval(()=>{q(),F()},1e4);return()=>clearInterval(e)},[]);const T=e=>{const{name:a,value:r}=e.target;C(e=>(0,t.A)((0,t.A)({},e),{},{[a]:r}))};return b?(0,n.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-50 dark:bg-gray-900 text-gray-500 dark:text-gray-400 transition-colors",children:(0,n.jsx)("div",{className:"text-xl font-medium animate-pulse",children:"Loading leaves..."})}):(0,n.jsxs)("div",{className:"p-6 max-w-[1200px] mx-auto bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-200",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Leaves"}),(0,n.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your leave applications"})]}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)(i,{variant:"secondary",onClick:()=>e("/employee/dashboard"),children:"Back to Dashboard"}),(0,n.jsx)(i,{onClick:()=>k(!0),children:"Apply Leave"})]})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:D.map(e=>{var a;return(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,n.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium mb-1",children:(null===(a=e.leave_type)||void 0===a?void 0:a.name)||"Leave"}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 mt-1",children:[(0,n.jsx)("span",{className:"text-2xl font-bold ".concat(e.remaining_days>0?"text-gray-900 dark:text-white":"text-red-600 dark:text-red-400"),children:e.remaining_days}),(0,n.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"days available"})]}),(0,n.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700 text-xs flex justify-between text-gray-400 dark:text-gray-500",children:[(0,n.jsxs)("span",{children:["Allocated: ",e.allocated_days]}),(0,n.jsxs)("span",{children:["Used: ",e.used_days]})]})]},e.id)})}),h&&(0,n.jsx)(c,{variant:"error",children:h}),_&&(0,n.jsxs)(c,{variant:"success",children:[(0,n.jsx)("strong",{children:"Success:"})," ",_]}),(0,n.jsx)(o,{className:"overflow-hidden",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,n.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),(0,n.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Dates & Duration"}),(0,n.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason"}),(0,n.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,n.jsx)("th",{className:"p-4 border-b border-gray-200 dark:border-gray-700 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Approved By"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.length>0?a.map(e=>{var a;const r=new Date(e.start_date),t=(new Date(e.end_date)-r)/864e5+1,d=e.approved_days?t-e.approved_days:0;return(0,n.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[(0,n.jsx)("td",{className:"p-4 text-sm font-medium text-gray-900 dark:text-white",children:(null===(a=e.leave_type)||void 0===a?void 0:a.name)||"Leave"}),(0,n.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("span",{className:"font-medium",children:[new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString()]}),(0,n.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:["Requested: ",t," days"]}),"Partially Approved"===e.status&&e.approved_days&&(0,n.jsxs)("div",{className:"flex flex-col gap-0.5 mt-1 border-l-2 border-blue-200 pl-2",children:[(0,n.jsxs)("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:["Approved: ",e.approved_days," days"]}),(0,n.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Returned: ",d," days"]})]})]})}),(0,n.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300 max-w-xs truncate",children:e.reason}),(0,n.jsx)("td",{className:"p-4 text-sm",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(x,{variant:e.status,children:e.status}),"Pending"===e.status&&e.start_date>=(new Date).toISOString().split("T")[0]&&(0,n.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to withdraw this leave request?"))try{await l.A.put("/leaves/".concat(e,"/withdraw")),A("Leave withdrawn successfully."),q(),F(),setTimeout(()=>A(null),3e3)}catch(t){var a,r;console.error("Withdraw error:",t),p((null===t||void 0===t||null===(a=t.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to withdraw leave."),setTimeout(()=>p(null),3e3)}})(e.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-xs rounded transition-colors shadow-sm font-medium",children:"Withdraw"})]})}),(0,n.jsx)("td",{className:"p-4 text-sm text-gray-700 dark:text-gray-300",children:e.approver?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:e.approver.name}),(0,n.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:1===e.approver.role_id?"SuperAdmin":2===e.approver.role_id?"Admin":3===e.approver.role_id?"HR":"Employee"})]}):(0,n.jsx)("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"-"})})]},e.id)}):(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:"5",className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"No leave applications found."})})})]})})}),(0,n.jsxs)(g,{isOpen:v,onClose:()=>k(!1),title:"Apply for Leave",children:[w&&(0,n.jsx)(c,{variant:"error",children:w}),(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),N(null);const a=S.leave_type_id?S.start_date?S.end_date?new Date(S.end_date)<new Date(S.start_date)?"End date cannot be before start date.":S.reason.trim()?null:"Please provide a reason.":"End date is required.":"Start date is required.":"Please select a leave type.";if(a)N(a);else{f(!0);try{await l.A.post("/leaves",S),A("Leave application submitted successfully!"),k(!1),C({leave_type_id:"",start_date:"",end_date:"",reason:""}),await q(),await F(),setTimeout(()=>A(null),3e3)}catch(d){var r,t;console.error("Apply leave error:",d),N((null===d||void 0===d||null===(r=d.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message)||"Failed to submit leave application.")}finally{f(!1)}}},className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"leave_type_id",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Leave Type"}),(0,n.jsxs)("select",{id:"leave_type_id",name:"leave_type_id",value:S.leave_type_id,onChange:T,required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"Select Type"}),y.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"start_date",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Start Date"}),(0,n.jsx)("input",{type:"date",id:"start_date",name:"start_date",value:S.start_date,onChange:T,required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"end_date",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"End Date"}),(0,n.jsx)("input",{type:"date",id:"end_date",name:"end_date",value:S.end_date,onChange:T,required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Reason"}),(0,n.jsx)("textarea",{id:"reason",name:"reason",value:S.reason,onChange:T,rows:"3",required:!0,className:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Please provide a reason for your leave..."})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,n.jsx)(i,{variant:"secondary",onClick:()=>k(!1),children:"Cancel"}),(0,n.jsx)(i,{type:"submit",disabled:j,children:j?"Applying...":"Apply Leave"})]})]})]})]})}}}]);
//# sourceMappingURL=778.47691ed5.chunk.js.map